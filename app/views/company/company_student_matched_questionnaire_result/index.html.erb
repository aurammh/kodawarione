<!--begin::Header-->
<% breadcrumbs_navigation_add (t('dashboard.company_student_matched_result')), '#' %>
<%= render_company_breadcrumbs_navigation(t('dashboard.company_student_matched_result')) %>	
<!--end::Header-->

<!--begin::Container-->
<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
    <!--begin::Container-->
    <div class="container-xxl" id="kt_content_container">
        <!--begin::Kodawari-->
        <ul class="nav row">       
            <% if can?(:index, Company::CompanyStudentMatchedResult) %>
                <li class="nav-item col-12 col-sm-6 col-md-6 col-lg-4 mb-5 mb-md-0 mb-lg-0 mb-xl-0">
                    <%= link_to company_company_student_matched_result_path, class: "nav-link btn btn-flex btn-color-gray-400 btn-outline btn-outline-default btn-active-primary d-flex flex-grow-1 flex-column flex-center py-3", :data => { :'bs-toggle' => 'tooltip', :'bs-trigger' => 'hover', :'bs-dismiss' => 'click', :'bs-placement' => 'right' } do %> 
                        <!--begin::Svg Icon | path: icons/duotune/general/gen008.svg-->
                        <span class="svg-icon svg-icon-2x mb-5 mx-0">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <rect x="0" y="0" width="24" height="24" />
                                    <path d="M5,3 L6,3 C6.55228475,3 7,3.44771525 7,4 L7,20 C7,20.5522847 6.55228475,21 6,21 L5,21 C4.44771525,21 4,20.5522847 4,20 L4,4 C4,3.44771525 4.44771525,3 5,3 Z M10,3 L11,3 C11.5522847,3 12,3.44771525 12,4 L12,20 C12,20.5522847 11.5522847,21 11,21 L10,21 C9.44771525,21 9,20.5522847 9,20 L9,4 C9,3.44771525 9.44771525,3 10,3 Z" fill="#000000" />
                                    <rect fill="#000000" opacity="0.3" transform="translate(17.825568, 11.945519) rotate(-19.000000) translate(-17.825568, -11.945519)" x="16.3255682" y="2.94551858" width="3" height="18" rx="1" />
                                </g>
                            </svg>
                        </span>
                        <!--end::Svg Icon-->
                        <span class="fs-6 fw-bolder"><%= t('search.type_matching_title') %></span>
                    <% end %>
                </li>
            <% end %>    
            <% if can?(:index, AssessmentMatchedResult) %>        
                <li class="nav-item col-12 col-sm-6 col-md-6 col-lg-4">
                    <%= link_to company_company_student_matched_questionnaire_result_path, class: "nav-link btn btn-flex btn-color-gray-400 btn-outline btn-outline-default btn-active-primary d-flex flex-grow-1 flex-column flex-center py-3 active",:data => { :'bs-toggle' => 'tooltip', :'bs-trigger' => 'hover', :'bs-dismiss' => 'click', :'bs-placement' => 'right' } do %> 
                        <!--begin::Svg Icon | path: icons/duotune/finance/fin006.svg-->
                        <span class="svg-icon svg-icon-2x mb-5 mx-0">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <rect x="0" y="0" width="24" height="24" />
                                        <rect fill="#000000" opacity="0.3" x="13" y="4" width="3" height="16" rx="1.5" />
                                        <rect fill="#000000" x="8" y="9" width="3" height="11" rx="1.5" />
                                        <rect fill="#000000" x="18" y="11" width="3" height="9" rx="1.5" />
                                        <rect fill="#000000" x="3" y="13" width="3" height="7" rx="1.5" />
                                    </g>
                                </svg>
                            </span>
                        <!--end::Svg Icon-->
                        <span class="fs-6 fw-bolder"><%= t('search.question_matching_title') %></span>
                    <% end %>
                </li>
            <% end %>            
        </ul>
        <div id="kt_search">
            <div class="search_form" data-kt-drawer="true" data-kt-drawer-name="search_form" data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true" data-kt-drawer-width="{default:'200px', '300px': '100%'}" data-kt-drawer-direction="start" data-kt-drawer-toggle="#search_form_toggle" data-kt-swapper="true" data-kt-swapper-mode="prepend" data-kt-swapper-parent="{default: '#kt_body', lg: '#kt_search'}"> 
                <div class="row mt-0 mt-md-0 mt-sm-0 mt-lg-10">
                    <!--begin::Search & Filter-->
                    <%= form_with(url: company_company_student_matched_questionnaire_result_path, method: :get) do |form| %>
                        <div id="filter-card" class="card bg-body mb-7">
                            <!--begin::Card Title-->
                            <div class="card-title d-flex d-md-flex d-lg-none d-xl-none align-item-center justify-content-center p-5">
                                <%= link_to  root_path,class: "flex-grow-1 mt-auto" do %>
                                    <%= image_tag "layout/header_logo.png", class: "h-25px h-lg-40px" %>   
                                <% end %>
                                <!--begin::Close-->
                                <div class="d-flex d-md-flex d-lg-none d-xl-none btn btn-sm btn-icon btn-light btn-color-muted btn-active-primary active">
                                    <span class="svg-icon svg-icon-2x" data-kt-drawer-dismiss="true">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                        <rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="black" />
                                        <rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="black" />
                                    </svg>
                                    </span>
                                </div>
                                <!--end::Close-->        
                            </div>
                            <!--end::Card Title-->
                            <!--begin::Card Body-->
                            <div class="card-body">
                                <div class="d-flex align-items-center">
                                    <!--begin::Region Search List-->
                                    <div class="flex-grow-1 flex-sm-grow-1 flex-md-grow-1 flex-lg-grow-1 flex-xl-grow-0 w-md-400px me-0 me-sm-0 me-md-0 me-lg-0 me-xl-5 my-3">
                                        <%= select_tag :address,options_for_select(prefecture_options_for_vacancy_search.map { |pref| [pref.prefecture_name, pref.id] },params[:address]),:prompt => '居住地',:class => 'form-select form-select-solid', id: "select2_1", :data => { :control => 'select2', 'hide-search' => true } %>
                                    </div>

                                    <!--begin::Clear & Search Btn-->
                                    <div class="d-none d-md-none d-lg-none d-xl-flex align-items-center my-3">
                                        <%= link_to t('search.clear'), company_company_student_matched_questionnaire_result_path, class: "btn btn-light-primary me-5" %>
                                        <%= form.submit t('search.apply'),class: "btn btn-primary" %>
                                    </div>
                                </div>

                                <div class="collapse show" id="kt_advanced_search_form">
                                    <div class="separator separator-dashed mt-9 mb-6"></div>
                                    <div class="row g-8 mb-8">
                                        <!--begin::Search string-->
                                        <div class="col-xxl-4">
                                            <%= form.label (t('search.keyword_search')), class: "fs-6 form-label fw-bolder text-dark" %>
                                            <div class="position-relative">
                                                <!--begin::Svg Icon | path: icons/duotune/general/gen021.svg-->
                                                <span class="svg-icon svg-icon-3 svg-icon-gray-500 position-absolute top-50 translate-middle ms-6">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                        <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="black"></rect>
                                                        <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="black"></path>
                                                    </svg>
                                                </span>
                                                <!--end::Svg Icon-->
                                                <%= form.text_field :keyword, class: "form-control form-control-solid ps-10 h-40px", value: (params[:keyword]), placeholder: t('search.keyword_search') %>
                                            </div>
                                        </div>   
                                        <!--end::Search string-->                        
                                        <!--begin::Desired Region Search List-->
                                        <div class="col-xxl-4">
                                            <%= form.label "希望勤務地", class: "fs-6 form-label fw-bolder text-dark" %>
                                            <%=  select_tag :desired_location,options_for_select(prefecture_options_for_vacancy_search.map { |pref| [pref.prefecture_name, pref.id] },params[:desired_location]),class: 'form-select form-select-solid', :multiple => true, data: {:placeholder => "希望勤務地", :control => 'select2', 'hide-search' => true, 'close-on-select' => false}, id: "select2_2"  %>  
                                        </div>
                                        <!--end::Desired Region Search List-->
                                        <!--begin::Prefecture Search List-->
                                        <div class="col-xxl-4">
                                            <%= form.label "希望職種", class: "fs-6 form-label fw-bolder text-dark" %>
                                            <%=  select_tag :jobcategory_id,options_for_select(occupation_options.map { |detail| [detail.occupation_name, detail.id] },params[:jobcategory_id]),class: 'form-select form-select-solid',:multiple => true, data: {:placeholder =>'希望職種', :control => 'select2', 'hide-search' => true, 'close-on-select' => false}, id: "select2_3"  %>
                                        </div>
                                        <!--end::Prefecture Search List-->
                                    </div>
                                </div>
                                <!--begin:Action-->
                                <div class="d-flex d-md-flex d-lg-flex d-xl-none border border-gray-500 border-dashed rounded justify-content-center min-w-100px my-3 p-2">
                                    <%= link_to t('search.clear'), company_company_student_matched_questionnaire_result_path, class: "btn btn-light-primary me-5" %>
                                    <%= form.submit t('search.apply'),class: "btn btn-primary" %>
                                    <!--<a id="kt_horizontal_search_advanced_link" class="btn btn-link" data-bs-toggle="collapse" href="#kt_advanced_search_form">Advanced Search</a>-->
                                </div>
                                <!--end:Action-->
                            </div>
                        </div>                
                    <% end %>      
                </div>
            </div>
        </div>
        <!--begin::Toolbar-->
        <div class="d-flex flex-wrap flex-stack pb-7 mt-5">
            <!--begin::Title-->
            <div class="d-flex flex-wrap align-items-center my-1">
                <h3 class="fw-bolder me-5 my-1">
                    <%= t'common.display' %> <%= @matched_result.total_count %> <%= t('search.count_unit') %>
                </h3>
            </div>
            <!--end::Title-->
            <div class="d-flex flex-wrap my-1 d-block d-lg-none">
                <!--begin::Tab nav-->
                <ul class="nav nav-pills mb-2 mb-sm-0">
                    <li class="nav-item m-0" id="search_form_toggle">
                        <a class="btn btn-sm btn-icon btn-light btn-color-muted btn-active-primary active">
                            <!--begin::Svg Icon | path: icons/duotune/abstract/abs015.svg-->
                            <span class="svg-icon svg-icon-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z" fill="black"></path>
                                    <path opacity="0.3" d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z" fill="black"></path>
                                </svg>
                            </span>
                            <!--end::Svg Icon-->
                        </a>
                    </li>
                </ul>
                <!--end::Tab nav-->
            </div>                      
        </div>
        <!--end::Toolbar-->
        <div class="row g-4">
            <% if @matched_result.present? %>
                <% @matched_result.each_with_index do |result,index| %>
                    <div class="col-xxl-4 col-xl-6 col-lg-6 col-md-6 col-12">
                        <div class="card card-custom card-stretch gutter-b bg-body border border-1 border-white border-hover-primary">
                            <%= link_to  company_student_details_path(id: result.student_id), class: "card-body p-5" do %>
                                <!--begin::Avatar-->
                                <div class="symbol symbol-100px symbol-circle mb-5 w-100 text-center">
                                    <% if @matched_result[index].image.present? %>
                                        <%= image_tag @matched_result[index].image %>
                                    <% else %>
                                        <% if result.gender == "female" %>
                                            <%= image_tag "avatar/female.svg" %>
                                        <% else %>
                                            <%= image_tag "avatar/male.svg" %> 
                                        <% end %>
                                    <% end %> 
                                </div>
                                <!--end::Avatar-->
                                <div class="text-center mb-2">
                                    <span class="fs-4 text-gray-800 text-hover-primary fw-bolder">
                                        <%= result.nick_name %>
                                    </span>
                                </div>
                                <div class="d-flex align-items-center my-5">
                                    <div class="d-flex align-items-center me-4">
                                        <div class="w-75px">
                                            <div class="single-chart">
                                                <svg viewBox="0 0 36 36" class="circular-chart primary">
                                                <path class="circle-bg"
                                                    d="M18 2.0845
                                                    a 15.9155 15.9155 0 0 1 0 31.831
                                                    a 15.9155 15.9155 0 0 1 0 -31.831"
                                                />
                                                <path class="circle"
                                                    stroke-dasharray="<%= result.overall_result.round %>, 100"
                                                    d="M18 2.0845
                                                    a 15.9155 15.9155 0 0 1 0 31.831
                                                    a 15.9155 15.9155 0 0 1 0 -31.831"
                                                />
                                                <text x="18" y="13" class="text">
                                                    マッチ度
                                                </text>
                                                <text x="18" y="25" class="percentage fw-bolder">
                                                    <%= result.overall_result.round %>%
                                                </text>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex flex-column flex-grow-1" >
                                        <div class="d-flex justif-content-between mb-5 flex-grow-1">
                                            <div style="border-left: 1px solid rgb(41, 160, 177); border-right: 1px solid rgb(41, 160, 177); height: 40px;"></div>
                                            <div class="d-flex flex-column w-75 flex-grow-1 ps-3">
                                                <span class="text-gray-800 fs-6 fw-bolder">
                                                    <%= result.current_address_result["label"] %>
                                                </span>
                                                <span class="text-gray-800 fs-8 fw-bold">
                                                    <%= result.current_address_result["value"] %>
                                                </span>
                                            </div>
                                            <span class="symbol symbol-40px">
                                                <span class="symbol-label bg-light-success">
                                                <span class="svg-icon svg-icon-1 svg-icon-success">
                                                    <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="24"
                                                    height="24"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                    >
                                                    <path
                                                        opacity="0.3"
                                                        d="M20.9 12.9C20.3 12.9 19.9 12.5 19.9 11.9C19.9 11.3 20.3 10.9 20.9 10.9H21.8C21.3 6.2 17.6 2.4 12.9 2V2.9C12.9 3.5 12.5 3.9 11.9 3.9C11.3 3.9 10.9 3.5 10.9 2.9V2C6.19999 2.5 2.4 6.2 2 10.9H2.89999C3.49999 10.9 3.89999 11.3 3.89999 11.9C3.89999 12.5 3.49999 12.9 2.89999 12.9H2C2.5 17.6 6.19999 21.4 10.9 21.8V20.9C10.9 20.3 11.3 19.9 11.9 19.9C12.5 19.9 12.9 20.3 12.9 20.9V21.8C17.6 21.3 21.4 17.6 21.8 12.9H20.9Z"
                                                        fill="black"
                                                    ></path>
                                                    <path
                                                        d="M16.9 10.9H13.6C13.4 10.6 13.2 10.4 12.9 10.2V5.90002C12.9 5.30002 12.5 4.90002 11.9 4.90002C11.3 4.90002 10.9 5.30002 10.9 5.90002V10.2C10.6 10.4 10.4 10.6 10.2 10.9H9.89999C9.29999 10.9 8.89999 11.3 8.89999 11.9C8.89999 12.5 9.29999 12.9 9.89999 12.9H10.2C10.4 13.2 10.6 13.4 10.9 13.6V13.9C10.9 14.5 11.3 14.9 11.9 14.9C12.5 14.9 12.9 14.5 12.9 13.9V13.6C13.2 13.4 13.4 13.2 13.6 12.9H16.9C17.5 12.9 17.9 12.5 17.9 11.9C17.9 11.3 17.5 10.9 16.9 10.9Z"
                                                        fill="black"
                                                    ></path>
                                                    </svg>
                                                </span>
                                                </span>
                                            </span>
                                        </div>
                                        <div class="d-flex justif-content-between mb-5 flex-grow-1">
                                            <div style="border-left: 1px solid rgb(255, 131, 0); border-right: 1px solid rgb(255, 131, 0); height: 40px;"></div>
                                            <div class="d-flex flex-column w-75 flex-grow-1 ps-3">
                                                <span class="text-gray-800 fs-6 fw-bolder">
                                                    <%= result.prefecture_name_result["label"] %>
                                                </span>
                                                <span class="text-gray-800 fs-8 fw-bold">
                                                    <%= result.prefecture_name_result["value"] %>
                                                </span>
                                            </div>
                                            <span class="symbol symbol-40px">
                                                <span class="symbol-label bg-light-danger">
                                                <span class="svg-icon svg-icon-1 svg-icon-danger">
                                                    <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="24px"
                                                    height="24px"
                                                    viewBox="0 0 24 24"
                                                    >
                                                    <g
                                                        stroke="none"
                                                        strokeWidth="1"
                                                        fill="none"
                                                        fillRule="evenodd"
                                                    >
                                                        <rect
                                                        x="5"
                                                        y="5"
                                                        width="5"
                                                        height="5"
                                                        rx="1"
                                                        fill="#000000"
                                                        ></rect>
                                                        <rect
                                                        x="14"
                                                        y="5"
                                                        width="5"
                                                        height="5"
                                                        rx="1"
                                                        fill="#000000"
                                                        opacity="0.3"
                                                        ></rect>
                                                        <rect
                                                        x="5"
                                                        y="14"
                                                        width="5"
                                                        height="5"
                                                        rx="1"
                                                        fill="#000000"
                                                        opacity="0.3"
                                                        ></rect>
                                                        <rect
                                                        x="14"
                                                        y="14"
                                                        width="5"
                                                        height="5"
                                                        rx="1"
                                                        fill="#000000"
                                                        opacity="0.3"
                                                        ></rect>
                                                    </g>
                                                    </svg>
                                                </span>
                                                </span>
                                            </span>
                                        </div>
                                        <div class="d-flex justif-content-between mb-5 flex-grow-1">
                                            <div style="border-left: 1px solid rgb(80, 205, 137); border-right: 1px solid rgb(80, 205, 137); height: 40px;"></div>
                                            <div class="d-flex flex-column w-75 flex-grow-1 ps-3">
                                                <span class="text-gray-800 fs-6 fw-bolder">
                                                    <%= result.occupation_name_result["label"] %>
                                                </span>
                                                <span class="text-gray-800 fs-8 fw-bold">
                                                    <%= result.occupation_name_result["value"] %>
                                                </span>
                                            </div>
                                            <span class="symbol symbol-40px">
                                                <span class="symbol-label bg-light-primary">
                                                <span class="svg-icon svg-icon-1 svg-icon-primary">
                                                    <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="24"
                                                    height="24"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                    >
                                                    <path
                                                        opacity="0.3"
                                                        d="M18.4 5.59998C21.9 9.09998 21.9 14.8 18.4 18.3C14.9 21.8 9.2 21.8 5.7 18.3L18.4 5.59998Z"
                                                        fill="black"
                                                    ></path>
                                                    <path
                                                        d="M12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2ZM19.9 11H13V8.8999C14.9 8.6999 16.7 8.00005 18.1 6.80005C19.1 8.00005 19.7 9.4 19.9 11ZM11 19.8999C9.7 19.6999 8.39999 19.2 7.39999 18.5C8.49999 17.7 9.7 17.2001 11 17.1001V19.8999ZM5.89999 6.90002C7.39999 8.10002 9.2 8.8 11 9V11.1001H4.10001C4.30001 9.4001 4.89999 8.00002 5.89999 6.90002ZM7.39999 5.5C8.49999 4.7 9.7 4.19998 11 4.09998V7C9.7 6.8 8.39999 6.3 7.39999 5.5ZM13 17.1001C14.3 17.3001 15.6 17.8 16.6 18.5C15.5 19.3 14.3 19.7999 13 19.8999V17.1001ZM13 4.09998C14.3 4.29998 15.6 4.8 16.6 5.5C15.5 6.3 14.3 6.80002 13 6.90002V4.09998ZM4.10001 13H11V15.1001C9.1 15.3001 7.29999 16 5.89999 17.2C4.89999 16 4.30001 14.6 4.10001 13ZM18.1 17.1001C16.6 15.9001 14.8 15.2 13 15V12.8999H19.9C19.7 14.5999 19.1 16.0001 18.1 17.1001Z"
                                                        fill="black"
                                                    ></path>
                                                    </svg>
                                                </span>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            <% end %>
                        </div>
                    </div>
                <% end %>
            <% else %>
                <div>
                    <div class="card card-body bg-white d-flex flex-row justify-content-center py-10">
                        <span class="label text-dark fs-3 fw-bolder">
                        該当データがあリません。
                        </span>
                    </div>
                </div>
            <% end %>
        </div>
        <!--start::Pagination-->
        <% if @matched_result.present?  %>
            <div class="d-flex flex-wrap justify-content-between align-items-center pt-2">
                <div class="d-flex flex-wrap">
                    <%= paginate @matched_result %>
                </div>
                <div class="d-flex align-items-center py-3">
                    <span class="text-muted"><%=  t('common.display')  %> <%= @matched_result.total_count %> <%=  t('common.to')  %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <%= @matched_result.offset_value + 1 %> ~ <%= @matched_result.offset_value + @matched_result.count %><%=  t('common.search_result')  %></span>
                </div>
            </div> 
        <% end %>
        <!--end::Pagination-->                  
        <!--end::Kodawari-->
    </div>
    <!--end::Content-->
</div>
<!--end::Container-->